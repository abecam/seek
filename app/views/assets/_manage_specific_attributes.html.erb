<%

  creators_enable = true if creators_enable.nil?
  creators_enable = creators_enable && f.object.respond_to?(:creators)
  other_creators ||= nil

  assays_enable = f.object.respond_to?(:positioned_assays)

  sharing_enable = true if sharing_enable.nil?
  sharing_enable = sharing_enable && f.object.can_manage?

  sharing_link = true if sharing_link.nil?
  sharing_link = sharing_link && f.try(:object).try(:is_a?, (Seek::Permissions::CodeBasedAuthorization)) && !f.try(:object).try(:new_record?)

  existing_creators ||= f.object.try(:creators)
  existing_creators = [current_user.person] if existing_creators.blank?

  other_creators ||= f.object.try(:other_creators)
%>

<% if assays_enable %>
  <p class="help-block">Re-arrange assays by clicking and dragging the button on the left-hand side of each row.</p>
  <table class="table" id="attribute-table">
    <thead>
    <tr>
      <th width="5em">Order</th>
      <th>Name</th>
    </tr>
    </thead>
    <tbody>
    <% f.object.positioned_assays.each do |assay| %>
      <tr>
        <td><%= assay.position -%></td>
        <td><%= assay.title -%></td>
      </tr>
    <% end %>

    </tbody>
  </table>

<% end -%>

<% if sharing_enable %>
  <%= render :partial => "sharing/form" -%>
<% end -%>

<% if creators_enable %>
  <%= render :partial => "assets/author_form", :locals => {:form => f,
                                                           :existing_creators => existing_creators,
                                                           :other_creators => other_creators} -%>
<% end %>

<% if sharing_link %>
  <%= render :partial => 'assets/special_auth_code_form', :locals => {:f => f} %>
<% end %>